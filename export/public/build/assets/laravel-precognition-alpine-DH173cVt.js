import{c as m,t as A,r as h,a as v,b as F,d as S}from"./laravel-precognition-Dlh9X1Tt.js";import{c,g as p,s as C}from"./lodash-es-BeZXkzNc.js";function T(e){e.magic("form",o=>(d,s,f,E={})=>{const l=c(f),g=Object.keys(l),u=e.reactive({touched:[],valid:[]}),i=m(t=>t[v(d)](h(s),r.data(),E),l).on("validatingChanged",()=>{r.validating=i.validating()}).on("validatedChanged",()=>{u.valid=i.valid()}).on("touchedChanged",()=>{u.touched=i.touched()}).on("errorsChanged",()=>{r.hasErrors=i.hasErrors(),r.errors=A(i.errors()),u.valid=i.valid()}),b=t=>({...t,precognitive:!1,onStart:()=>{r.processing=!0,(t.onStart??(()=>null))()},onFinish:()=>{r.processing=!1,(t.onFinish??(()=>null))()},onValidationError:(n,a)=>(i.setErrors(n.data.errors),t.onValidationError?t.onValidationError(n):Promise.reject(a))}),y=()=>({...c(f),data(){const t=c(r);return g.reduce((n,a)=>({...n,[a]:t[a]}),{})},touched(t){return u.touched.includes(t)},touch(t){return i.touch(t),r},validate(t,n){return typeof t=="object"&&!("target"in t)&&(n=t,t=void 0),typeof t>"u"?i.validate(n):(t=F(t),i.validate(t,p(r.data(),t),n)),r},validating:!1,valid(t){return u.valid.includes(t)},invalid(t){return typeof r.errors[t]<"u"},errors:{},hasErrors:!1,setErrors(t){return i.setErrors(t),r},forgetError(t){return i.forgetError(t),r},reset(...t){const n=c(l);return t.length===0?g.forEach(a=>r[a]=n[a]):t.forEach(a=>C(r,a,p(n,a))),i.reset(...t),r},setValidationTimeout(t){return i.setTimeout(t),r},processing:!1,async submit(t={}){return S[v(d)](h(s),r.data(),b(t))},validateFiles(){return i.validateFiles(),r}}),r=e.reactive(y());return V(o,v(d),h(s),r),r})}const V=(e,o,d,s)=>{e instanceof Element&&e.nodeName==="FORM"&&(x(e,o),j(e,o),M(e,d),D(e,s))},j=(e,o)=>{o!=="get"&&!e.hasAttribute("method")&&e.setAttribute("method","POST")},M=(e,o)=>{e.hasAttribute("action")||e.setAttribute("action",o)},x=(e,o)=>{if(["get","post"].includes(o)||e.querySelector('input[type="hidden"][name="_method"]')!==null)return;const s=e.insertAdjacentElement("afterbegin",document.createElement("input"));s!==null&&(s.setAttribute("type","hidden"),s.setAttribute("name","_method"),s.setAttribute("value",o.toUpperCase()))},D=(e,o)=>e.addEventListener("submit",()=>o.processing=!0);export{T as p};
